<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Surprise</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<div>
						<h2>Walks like java, talks like java but not quite java</h2>
						<img data-src="images/kotlin.png" width="250" height="250" style="vertical-align:middle">
					</div>
					<aside class="notes">
							some notes and stuff
					</aside>
				</section>

				<section>
					<ul>
						<li>Made by JetBrains</li>
						<li>Compiles to JVM bytecode or Javascript or native</li>
						<li>100% compatible with Java</li>
						<li>Supported in Spring Framework and Spring Boot</li>
						<li>Great tooling support</li>
						<li>Automatic covert Java to Kotlin</li>
					</ul>
				</section>

				<section>
					<h3>Features</h3>
					<section><h4>Type inference (also smart casting)</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							val name: "name" // knows it is a string
							name = 1 // error: integer is not a string
							
							var test: Any? = null;
							if (test is String) {
								test.length // knows test here is string
							}
							</code></pre>
						</div>
					</section>
					<section>
						<h4>Null safety</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							var notNullable: String = "abc"
							notNullable = null // error: non-null type String
							var nullable: String ? = "abc"
							var nullable = null // ok

							nullable.length // error: nullable can be null
							nullable?.length // null null else length
							nullable?.length ?: -1 // elvis: -1 if null else length
							if(nullable != null) { 
								nullable.length 
							} // smart enough to know nullable can not be null
							</code></pre>
						</div>
					</section>
					<section> 
						<h4>Immutability</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							val immutable = "abc";
							immutable = "d" // error: val cannot be unassigned

							class Test{ }
							class OpenTest{ }
							class Other: Test() { } // error: Test is final
							class Other: OpenTest() { } // ok

							val readOnly = listOf(1, 2, 3)
							readOnly.add(2) // no add method
							val mutableList = mutableListOf(1, 2, 3)
							mutableList.add(2) // ok
							</code></pre>
						</div>
					</section>
					<section><h4>String interpolation</h4>
					<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							val name = "name"
							println("Name $name")
							</code></pre>
						</div>
					</section>
					<section><h4>Data classes</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							data class User(val name: String, val age: Int)
							// generates equals/hashcode
							// generates toString and copy
							</code></pre>
						</div>
						<ul>
							<li>Great for DTO's</li>
							<li>Great for Value Objects</li>
						</ul>
					</section>
					<section><h4>Lambda's</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							val items = ArrayList&ltString>()
							items.sortBy { it.length() } // implicit name of parameter
							items.filter { it.length == 5 }.sortBy { it }
							map.forEach { _, value -> println("$value!") }
							
							fun &ltT> max(collection: Collection&ltT>, 
								less: (T, T) -> Boolean): T?
								// function as a prameter
							</code></pre>
						</div>
					</section>
					<section><h4>Extension functions</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							fun String.doSomething() = "--- $this ---"
							// extends String with doSomething function
							
							val name = "name"
							name.doSomething() // can call it now
							</code></pre>
						</div>
					</section>
					<section><h4>==</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch"
						 >
							"name" == "name" // is finally true

							data class Test(val name: String)
							Test("a") == Test("a") // is also true
							Test("a") === Test("a") // not true
							</code></pre>
						</div>
					</section>
					<section><h4>Function parameters(named, default, infix)</h4>
						<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							fun named(a: String, b: String) {}
							named(b = "b", a = "a")
							named("a", "b")

							fun default(a: String = "a", b: String){ }
							default(b = "b")
							default("a", "b")

							infix fun Int.infixf(x: Int): String {
								return "string"
							}
							1 infixf 2

							fun test() = "result"
							// No need for a body and return and all that
							</code></pre>
						</div>
						</section> 
					<section><h4>Pattern matching</h4>
					<div>
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							fun match1(obj: Any) {
								when (obj) {
									is String -> println("String")
									else -> println("other")
								}
							}
							
							fun match2(number: Int) {
								when (number) {
									1 -> println("1")
									2 -> println("2")
								}
							}

							data class Person(val name: String, val age: Int)
							fun match3(person: Person) {
								when {
									person.name == "me" -> println("me")
									person.age > 30 -> println("old")
								}
							}
							</code></pre>
						</div>
					</section>
					<section><h4>Other goodies</h4>
						<div>
						<ul>
							<li>Destructuring</li>
							<li>Ranges</li>
							<li>Operator overloading</li>
							<li>Builders</li>
							<li>invoke (similar to apply() in scala)</li>
							<li>Companion objects</li>
						</ul>
						</div>
					</section>
				</section>

				<section>
					<h3>How it can make our lives easier</h3>
					<section><h4>Protobuf</h4>
						KBuilders
						<pre> <code data-trim data-noescape class="kotlin stretch" >
							var dto = buildDTO {
								playerUid = "123"
								timestamp = LocalDateTime.now()
							}

							var modifiedDTO = dto.rebuild {
								playerUid = "456"
							}
							</code></pre>
					</section>
					<section><h4>Spring - Bean creation</h4>
					
					<pre> <code data-trim data-noescape class="kotlin stretch" >
						@Bean
						open fun someBean() = SomeBean()
						</code></pre>
					</section>
					<section><h4>Spring - Boot application</h4>
					<pre> <code data-trim data-noescape class="kotlin stretch" >
						@SpringBootApplication
						class Application
						
						fun main(args: Array<String>) { // no need to have this in a class
							SpringApplication.run(Application::class.java, *args)
						}
						</code></pre>
					</section>
					<section><h4>Spring - DTO's/entities</h4>
					<pre> <code data-trim data-noescape class="kotlin stretch" >
						// can all be defined in a single file to have better overview
						data class Player(val name: String, val age: Int)
						data class Game(val name: String

						@Entity
						data class Player(
							@Id
							@GeneratedValue
							val id: Int = 0,
							val name: String = "")
						</code></pre>
					</section>
					<section><h4>Testing</h4>
					<pre> <code data-trim data-noescape class="kotlin stretch" >
						@Test
						fun `test with spaces`() { } // more discriptive names

						// Using Spek (also tests java code)
						class SimpleTest : Spek({
							describe("a specification") {
								
								it("should do something") {
								}
								
								it("should do something else") {
								}
							}

							describe("bit more special") {
								listOf(1, 2, 3).forEach { number -> 
									it("assert something") {
										assertThat(number).isGreatThan(0)
									}
								}
							}
						})

						</code></pre>
					</section>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
